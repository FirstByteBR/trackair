<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LEDS ‚Äì Infogr√°fico Responsivo</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://i.ibb.co/N2Dc3q53/logo.png">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@700;900&family=Segoe+UI:wght@400;700&display=swap" rel="stylesheet">
    

    <style>
        :root {
            --text-color: white;
            --bg-gradient: linear-gradient(60deg, rgba(23, 13, 194, 1) 0%, rgba(41, 41, 237, 1) 50%, rgba(0, 212, 255, 1) 100%);
            --header-bg: rgba(0, 0, 0, 0.65);
            --section-bg: rgba(255, 255, 255, 0.1);
            --section-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            --button-bg: rgba(255, 255, 255, 0.2);
            --button-bg-hover: rgba(255, 255, 255, 0.35);
            --button-bg-active: rgba(255, 255, 255, 0.6);
            --button-radius: 10px;
            --section-radius: 20px;
            --widget-bg: rgba(255, 255, 255, 0.1);
            --widget-bg-hover: rgba(255, 255, 255, 0.2);
            --widget-radius: 8px;

            --font-primary: 'Segoe UI', sans-serif;
            --font-display: 'Rubik', sans-serif;

            --header-height: 70px;
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            padding-top: var(--header-height);
            text-align: center;
            background-image: var(--bg-gradient);
            background-attachment: fixed;
            min-height: 100vh;
        }

        header {
            background-color: var(--header-bg);
            padding: 15px 20px;
            font-size: 1.8rem;
            font-weight: bold;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: var(--header-height);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        #relogio {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            right: 20px;
            font-size: 1.4rem;
            font-family: var(--font-display);
            background-color: var(--widget-bg);
            padding: 6px 12px;
            border-radius: var(--widget-radius);
            color: var(--text-color);
        }

        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 20px;
            gap: 30px;
        }

        section {
            background-color: var(--section-bg);
            border-radius: var(--section-radius);
            padding: 30px;
            max-width: 900px;
            width: 95%;
            box-shadow: var(--section-shadow);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .subtitulo {
            color: white;
            font-size: 1.6rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .numero-co2, .numero-co2s {
            font-family: var(--font-display);
            font-size: 3.5rem;
            color: var(--text-color);
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.4);
            margin: 15px 0;
            display: inline-block;
            line-height: 1.1;
            font-weight: 900;
        }

        .numero-co2s {
            font-size: 2.5rem;
        }

        .descricao {
            color: white;
            font-size: 1.3rem;
            margin-top: 0;
            margin-bottom: 10px;
            min-height: 1.5em;
        }

        .legenda {
            font-size: 1rem;
            opacity: 0.85;
            margin-top: 15px;
        }
        /* Ajuste de cor para hiperlinks dentro de .legenda */
        .legenda a {
            color: #00d4ff; /* Azul claro */
            text-decoration: none; /* Remover sublinhado padr√£o */
        }

        .legenda a:hover {
            text-decoration: underline; /* Adicionar sublinhado ao passar o mouse */
        }

        .botoes {
            margin-top: 25px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        .botao {
            background: var(--button-bg);
            color: var(--text-color);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 10px 18px;
            font-size: 0.95rem;
            border-radius: var(--button-radius);
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
            font-family: var(--font-primary);
        }

        .botao:hover {
            background: var(--button-bg-hover);
            transform: scale(1.05);
        }

        .botao.ativo {
            background: var(--button-bg-active);
            color: #1a1a1a;
            font-weight: 700;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        /* Year Selector */
        .year-selector-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .year-selector-label {
            font-size: 1.1rem;
            color: var(--text-color);
            opacity: 0.9;
        }

        .year-selector {
            position: relative;
            min-width: 120px;
            background-color: var(--button-bg);
            color: var(--text-color);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--button-radius);
            padding: 10px 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .year-selector:hover, .year-selector:focus-within {
            background-color: var(--button-bg-hover);
            transform: translateY(-2px) scale(1.03);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .selected-year {
            font-family: var(--font-display);
            font-size: 1.1rem;
        }

        .dropdown-arrow {
            width: 18px;
            height: 18px;
            transition: transform 0.3s ease;
            stroke: var(--text-color);
        }

        .year-selector.open .dropdown-arrow {
            transform: rotate(180deg);
        }

        .year-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            width: 100%;
            background-color: rgba(0,0,0,0.8);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: var(--button-radius);
            max-height: 0;
            overflow-y: auto;
            z-index: 10;
            opacity: 0;
            transform: translateY(10px) scaleY(0.95);
            transform-origin: top center;
            transition: max-height 0.4s ease-in-out, opacity 0.3s ease-in-out, transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            padding: 5px 0;
        }

        .year-dropdown::-webkit-scrollbar {
            width: 8px;
        }
        .year-dropdown::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        .year-dropdown::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            transition: background 0.2s ease;
        }
        .year-dropdown::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.5);
        }

        .year-selector.open .year-dropdown {
            max-height: 200px;
            opacity: 1;
            transform: translateY(0) scaleY(1);
        }

        .year-dropdown div {
            padding: 10px 15px;
            color: var(--text-color);
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease;
            font-size: 0.95rem;
        }

        .year-dropdown div:hover {
            background-color: var(--button-bg-hover);
            transform: translateX(3px);
        }
        .year-dropdown div.selected-item {
            background-color: var(--button-bg-active);
            color: #1a1a1a;
            font-weight: bold;
        }

        /* Logo Styles */
        .logo-container {
            position: fixed;
            top: calc(var(--header-height) + 15px);
            right: 15px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 100;
        }
        .logo-container-lefty {
            position: fixed;
            top: calc(var(--header-height) + 15px);
            left: 15px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
            z-index: 100;
        }

        .logo-img {
            display: block;
            backdrop-filter: blur(6px);
            border-radius: var(--widget-radius);
            padding: 8px;
            background-color: rgba(255, 255, 255, 0.65);
            max-width: 100%;
            object-fit: contain;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .logoObs { width: 300px; height: auto; }
        .logoCop { width: 300px; height: auto; }
        .logoNew { width: 400px; height: auto; }

        /* Agro Input Styles */
        .agro-input-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            text-align: left;
        }

        .agro-input-group {
            display: flex; /* Default to flex, will be overridden to none for hidden fields */
            flex-direction: column;
            gap: 5px;
        }

        .agro-input-group label {
            font-weight: bold;
            font-size: 1.1rem;
            color: white;
        }

        .agro-input {
            background-color: rgba(0, 0, 0, 0.4);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: var(--button-radius);
            padding: 12px 15px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .agro-input:focus {
            background-color: rgba(0, 0, 0, 0.6);
            border-color: rgba(255, 255, 255, 0.7);
            outline: none;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
        }

        .agro-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .agro-result {
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            min-height: 1.5em;
        }

        /* Chart Styles - Centralizados */
        .charts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
        }

        .chart-wrapper {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--section-radius);
            padding: 15px;
            backdrop-filter: blur(5px);
            display: flex;
            flex-direction: column;
            align-items: center; /* Centraliza o conte√∫do (incluindo o chart-container) */
        }

        .chart-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .chart-container {
            width: 100%;
            display: flex;
            justify-content: center; /* Garante que o canvas dentro dele esteja centralizado */
            /* Min-height para os gr√°ficos n√£o ficarem muito achatados */
            min-height: 250px; 
        }

        canvas {
            max-width: 100%;
            height: auto; /* Garante que a altura se ajuste para manter a propor√ß√£o */
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            header { font-size: 1.5rem; padding: 12px 15px; }
            #relogio { font-size: 1.2rem; right: 15px; padding: 5px 10px; }
            .numero-co2 { font-size: 3rem; }
            .numero-co2s { font-size: 2.2rem; }
            .descricao { font-size: 1.2rem; }
            .subtitulo { font-size: 1.4rem; gap: 8px; }
            section { padding: 25px; }
            .logo-container, .logo-container-lefty { top: calc(var(--header-height) + 10px); transform: none; gap: 5px; }
            .logo-container { right: 10px; }
            .logo-container-lefty { left: 10px; }
            .logoObs, .logoCop, .logoNew { width: 130px; }
            .charts-container { flex-direction: column; }
        }

        @media (max-width: 480px) {
            body { padding-top: 60px; }
            header { font-size: 1.2rem; justify-content: flex-start; padding-left: 15px; min-height: 60px; }
            .header-content{ margin-right: 70px; }
            #relogio { font-size: 1rem; top: 50%; transform: translateY(-50%); right: 10px; padding: 4px 8px; }
            main { padding: 20px 10px; }
            section { padding: 20px 15px; width: 100%; }
            .numero-co2 { font-size: 2.5rem; }
            .numero-co2s { font-size: 1.8rem; }
            .descricao { font-size: 1.1rem; }
            .subtitulo { font-size: 1.2rem; flex-direction: column; gap: 5px; }
            .legenda { font-size: 0.9rem; }
            .botao { padding: 8px 15px; font-size: 0.9rem; }
            .logo-container, .logo-container-lefty { position: static; transform: none; flex-direction: row; justify-content: center; width: 100%; margin-bottom: 15px; padding: 0 10px; }
            .logoObs, .logoCop, .logoNew { width: 70px; padding: 5px; }
            .logo-container > .logo-img, .logo-container-lefty > .logo-img { margin: 0 5px; }
        }
    </style>
</head>

<body>
    <header>
        <span class="header-content">LEDS ‚Äì Infogr√°fico Responsivo</span>
        <div id="relogio">--:--</div>
    </header>

    <div class="logo-container">
        <img class="logo-img logoNew" src="https://i.ibb.co/NGHmfxp/logo100anos.png" alt="Logo Marista Santa Maria 100 anos">
    </div>
    <div class="logo-container-lefty">
        <img class="logo-img logoCop" src="https://i.ibb.co/xbfmWBy/Logo-COP-fundo-transparente.png" alt="Logo COP Col√©gio Marista Santa Maria">
        <img class="logo-img logoObs" src="https://i.ibb.co/HfxV4y9b/Logo-Observat-rio-fundo-transparente.png" alt="Logo Observat√≥rio Marista">
    </div>

    <main>
        <!-- Se√ß√µes originais mantidas -->
        <section>
            <a class="subtitulo" href="live-ic.html">Dados ao vivo</a> <a class="subtitulo" href="3d-info.html">Visualizador 3D</a>
        </section>
        <section> 
            <div class="subtitulo" id="tituloPagina">üåç Emiss√µes Globais de CO‚ÇÇ em Tempo Real</div>
            <div class="numero-co2" id="co2Numero" aria-live="polite">...</div>
            <div class="descricao" id="co2Descricao">toneladas emitidas at√© agora em 2025</div>
            <div class="legenda" id="co2Legenda">Estimativa para 2025: 37,4 bilh√µes de toneladas</div>
            <div class="botoes" id="botoesRegiao">
                <button class="botao" id="btnMundo" data-pagina="mundo">Mundo</button>
                <button class="botao" id="btnBrasil" data-pagina="brasil">Brasil</button>
                <button class="botao" id="btnParana" data-pagina="parana">Paran√°</button>
                <button class="botao" id="btnCuritiba" data-pagina="curitiba">Curitiba</button>
            </div>
        </section>

        <section>
            <div class="subtitulo" id="tituloPagina2">üåç Emiss√µes Globais de CO‚ÇÇ desde a cria√ß√£o do Marista</div>
            <div class="numero-co2s" id="co2Numero2" aria-live="polite">...</div>
            <div class="descricao" id="co2Descricao2">toneladas emitidas desde a cria√ß√£o do Marista</div>
            <div class="botoes" id="botoesHistorico">
                <button class="botao" id="btnMarista" data-pagina2="Marista">Marista</button>
                <button class="botao" id="btnSanta" data-pagina2="Santa">Santa Maria</button>
            </div>
        </section>

        <section>
            <div class="subtitulo" id="tituloPagina3">üìÖ Emiss√µes Globais de CO‚ÇÇ Desde um Ano Espec√≠fico</div>
            <div class="year-selector-container">
                <span class="year-selector-label">Ano:</span>
                <div class="year-selector" id="yearSelector" tabindex="0">
                    <span class="selected-year" id="selectedYearDisplay">1990</span>
                    <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <div class="year-dropdown" id="yearDropdownList">
                        <!-- Years will be populated by JavaScript -->
                    </div>
                </div>
                <button class="botao" id="btnCalcularAno" style="margin-left: 15px;">Calcular</button>
            </div>
            <div class="numero-co2" id="co2Numero3" aria-live="polite" style="font-size: 2.8rem;">...</div>
            <div class="descricao" id="co2Descricao3">...</div>
            <p id="erroAno" style="color: #ffdddd; font-weight: bold; min-height: 1.2em; margin-top:10px;"></p>
        </section>

        <!-- Nova se√ß√£o: Calculadora de Emiss√µes do Agroneg√≥cio -->
        <section>
            <div class="subtitulo">üå± Calculadora de Emiss√µes do Agroneg√≥cio</div>
            <div class="agro-input-container">
                <div class="agro-input-group">
                    <label for="agro-activity">Atividade:</label>
                    <select id="agro-activity" class="agro-input">
                        <option value="soja">Soja</option>
                        <option value="milho">Milho</option>
                        <option value="cana">Cana-de-a√ß√∫car</option>
                        <option value="pecuaria">Pecu√°ria (gado de corte)</option>
                    </select>
                </div>
                <div class="agro-input-group">
                    <label for="agro-area">√Årea (hectares):</label>
                    <input type="number" id="agro-area" class="agro-input" placeholder="Ex: 1000" min="0">
                </div>
                <div class="agro-input-group" id="agroCattleGroup"> <!-- Added ID for easier JS access -->
                    <label for="agro-cattle">N√∫mero de cabe√ßas (apenas para pecu√°ria):</label>
                    <input type="number" id="agro-cattle" class="agro-input" placeholder="Ex: 500" min="0">
                </div>
            </div>
            <button class="botao" id="btnCalcularAgro">Calcular Emiss√µes</button>
            <div class="agro-result" id="agroResult"></div>
            <div class="legenda">Baseado em dados do <a href="https://seeg.eco.br/" target="_blank" rel="noopener noreferrer">SEEG</a> (Sistema de Estimativas de Emiss√µes de Gases de Efeito Estufa) e <a href="https://www.embrapa.br/" target="_blank" rel="noopener noreferrer">EMBRAPA</a></div>
        </section>

        <!-- Nova se√ß√£o: Gr√°ficos Comparativos -->
        <section>
            <div class="subtitulo">üìä An√°lise Comparativa do Agroneg√≥cio</div>
            
            <div class="charts-container">
                <div class="chart-wrapper">
                    <div class="chart-title">Emiss√µes por Cultura (tCO‚ÇÇeq/ha/ano)</div>
                    <div class="chart-container">
                        <canvas id="emissionsChart"></canvas>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <div class="chart-title">√Årea Cultivada no Brasil (milh√µes de ha)</div>
                    <div class="chart-container">
                        <canvas id="areaChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-wrapper">
                    <div class="chart-title">Emiss√µes do Agroneg√≥cio por Tipo (2022)</div>
                    <div class="chart-container">
                        <canvas id="sectorChart"></canvas>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <div class="chart-title">Compara√ß√£o Agroneg√≥cio vs Agricultura Familiar</div>
                    <div class="chart-container">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="legenda">Fontes: <a href="https://seeg.eco.br/" target="_blank" rel="noopener noreferrer">SEEG</a>, <a href="https://www.embrapa.br/" target="_blank" rel="noopener noreferrer">EMBRAPA</a>, <a href="https://www.ibge.gov.br/" target="_blank" rel="noopener noreferrer">IBGE</a> e <a href="https://www.conab.gov.br/" target="_blank" rel="noopener noreferrer">CONAB</a> - Dados de 2022</div>
        </section>
    </main>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        "use strict";

        // Dados de emiss√µes do agroneg√≥cio atualizados com base em https://indicadores.agro.gov.br/
        const agroEmissions = {
            soja: 0.85, // tCO2eq por hectare por ano (SEEG/EMBRAPA)
            milho: 0.72, // tCO2eq por hectare por ano (SEEG/EMBRAPA)
            cana: 0.45, // tCO2eq por hectare por ano (SEEG - considerando queima)
            pecuaria: 56.2 // tCO2eq por cabe√ßa por ano (SEEG - gado de corte)
        };

        // Dados hist√≥ricos de emiss√µes de CO2 (AGORA COM DADOS COMPLETOS DESDE 1750)
        const co2EmissionsByYear = {
            "1750": 0.009305937, "1751": 0.009407229, "1752": 0.009505168, "1753": 0.00961049, "1754": 0.00973358, "1755": 0.009793468, "1756": 0.009909914, "1757": 0.010093936, "1758": 0.010216358, "1759": 0.010338854, "1760": 0.010514331, "1761": 0.010747885, "1762": 0.010952198, "1763": 0.011191592, "1764": 0.011396982, "1765": 0.011643486, "1766": 0.01187608, "1767": 0.012152509, "1768": 0.012466936, "1769": 0.012780074, "1770": 0.013097216, "1771": 0.013369488, "1772": 0.013623507, "1773": 0.013808138, "1774": 0.014012415, "1775": 0.01433892, "1776": 0.014654124, "1777": 0.014959537, "1778": 0.015243483, "1779": 0.015535235, "1780": 0.015878726, "1781": 0.016234383, "1782": 0.016580954, "1783": 0.017062751, "1784": 0.017471093, "1785": 0.017965127, "1786": 0.018447497, "1787": 0.01885913, "1788": 0.019286229, "1789": 0.019863425, "1790": 0.020398094, "1791": 0.020931749, "1792": 0.021929215, "1793": 0.022297261, "1794": 0.022519656, "1795": 0.022315246, "1796": 0.022121375, "1797": 0.022090078, "1798": 0.023105929, "1799": 0.027485207,
            "1800": 0.032798352, "1801": 0.03198605, "1802": 0.040310473, "1803": 0.029538506, "1804": 0.031769177, "1805": 0.031251817, "1806": 0.032704622, "1807": 0.036200654, "1808": 0.035497789, "1809": 0.036333813, "1810": 0.039492312, "1811": 0.040176681, "1812": 0.040814523, "1813": 0.041206139, "1814": 0.042226646, "1815": 0.043587265, "1816": 0.045496577, "1817": 0.049275922, "1818": 0.05139201, "1819": 0.050930167, "1820": 0.050733074, "1821": 0.052059349, "1822": 0.054021712, "1823": 0.056357763, "1824": 0.057583637, "1825": 0.060730867, "1826": 0.06138213, "1827": 0.065738568, "1828": 0.06668179, "1829": 0.066307408, "1830": 0.088988498, "1831": 0.083250906, "1832": 0.082091751, "1833": 0.083248945, "1834": 0.088763111, "1835": 0.097399594, "1836": 0.106894495, "1837": 0.106199422, "1838": 0.105845261, "1839": 0.109653034, "1840": 0.118808512, "1841": 0.122165547, "1842": 0.129388789, "1843": 0.132369389, "1844": 0.141966448, "1845": 0.155073404, "1846": 0.157701789, "1847": 0.170796751, "1848": 0.17364348, "1849": 0.185048032,
            "1850": 0.196847595, "1851": 0.198778547, "1852": 0.207595091, "1853": 0.217236968, "1854": 0.255038557, "1855": 0.260259851, "1856": 0.278245627, "1857": 0.281181048, "1858": 0.28554839, "1859": 0.302572176, "1860": 0.332298456, "1861": 0.349190174, "1862": 0.355991078, "1863": 0.379534888, "1864": 0.409525433, "1865": 0.43485133, "1866": 0.449067025, "1867": 0.480813908, "1868": 0.494493527, "1869": 0.524731062, "1870": 0.536123276, "1871": 0.569776587, "1872": 0.630961473, "1873": 0.670467213, "1874": 0.628662235, "1875": 0.681047983, "1876": 0.690582523, "1877": 0.704032862, "1878": 0.709649549, "1879": 0.75979439, "1880": 0.858055674, "1881": 0.887964969, "1882": 0.937888221, "1883": 0.997514559, "1884": 1.009429803, "1885": 1.01714455, "1886": 1.032613676, "1887": 1.083727515, "1888": 1.20080164, "1889": 1.201516232, "1890": 1.306591164, "1891": 1.368915607, "1892": 1.379808961, "1893": 1.362515016, "1894": 1.411532927, "1895": 1.495238838, "1896": 1.544660873, "1897": 1.617492798, "1898": 1.705960878, "1899": 1.863135385,
            "1900": 1.96149074, "1901": 2.023963811, "1902": 2.074800354, "1903": 2.262046168, "1904": 2.28750933, "1905": 2.437062082, "1906": 2.544485736, "1907": 2.900324676, "1908": 2.785686667, "1909": 2.901167235, "1910": 3.0433259, "1911": 3.090098124, "1912": 3.246477083, "1913": 3.516532973, "1914": 3.189786302, "1915": 3.140276533, "1916": 3.391973242, "1917": 3.54813832, "1918": 3.499686323, "1919": 3.033839374, "1920": 3.537837259, "1921": 3.106184128, "1922": 3.254462643, "1923": 3.690697713, "1924": 3.702777064, "1925": 3.740633513, "1926": 3.677407432, "1927": 4.012947385, "1928": 3.99631173, "1929": 4.288211409, "1930": 3.958095957, "1931": 3.539320339, "1932": 3.192591529, "1933": 3.362683413, "1934": 3.656187221, "1935": 3.83574255, "1936": 4.207930753, "1937": 4.496715384, "1938": 4.229619213, "1939": 4.470134676, "1940": 4.884663525, "1941": 4.999092726, "1942": 4.982524053, "1943": 5.0752732, "1944": 5.162486555, "1945": 4.28931269, "1946": 4.608546995, "1947": 5.165205488, "1948": 5.447884758, "1949": 5.204035324,
            "1950": 5.93024384,  "1951": 6.381428815, "1952": 6.467460418, "1953": 6.650885226, "1954": 6.789529059, "1955": 7.443895798, "1956": 7.926012519, "1957": 8.185644782, "1958": 8.417187818, "1959": 8.854689147, "1960": 9.387010408, "1961": 9.415042136, "1962": 9.747287164, "1963": 10.26677221,  "1964": 10.8244661,  "1965": 11.31060044, "1966": 11.86264632, "1967": 12.23736928, "1968": 12.90528307, "1969": 13.76178529, "1970": 14.89912444, "1971": 15.50385472, "1972": 16.22459665, "1973": 17.0850929,   "1974": 17.01107168, "1975": 17.05275263, "1976": 17.98911207, "1977": 18.49863422, "1978": 19.06929054, "1979": 19.60902029, "1980": 19.48852441, "1981": 19.02290478, "1982": 18.87109791, "1983": 18.99191043, "1984": 19.64780142, "1985": 20.31190163, "1986": 20.61496319, "1987": 21.2500746,   "1988": 22.08513001, "1989": 22.38663748, "1990": 22.7289883,  "1991": 23.18610144, "1992": 22.52817203, "1993": 22.75578699, "1994": 22.9929469,  "1995": 23.53208301, "1996": 24.25816745, "1997": 24.40190571, "1998": 24.30377731, "1999": 24.85372768,
            "2000": 25.5105528,  "2001": 25.70629345, "2002": 26.27686873, "2003": 27.66948979, "2004": 28.63250593, "2005": 29.6143941,  "2006": 30.6283961,  "2007": 31.53464403, "2008": 32.07419856, "2009": 31.54192194, "2010": 33.35590344, "2011": 34.50453812, "2012": 35.00002034, "2013": 35.30165585, "2014": 35.45009475, "2015": 35.40489697, "2016": 35.41665608, "2017": 35.98989788, "2018": 36.73042656, "2019": 37.10427786, "2020": 35.12652612, "2021": 36.99173628, "2022": 37.29383639, "2023": 37.79156871
        };

        // Estimate for 2024 annual emissions (in tonnes)
        const EMISSIONS_2024_ANNUAL = 37.9e9;

        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM Content Loaded. Script starting.");

            // Dados de emiss√µes por regi√£o
            const emissoes = {
                mundo: { anual: 37.4e9, titulo: "üåç Emiss√µes Globais de CO‚ÇÇ", legenda: "Estimativa para 2025: 37,4 bilh√µes de toneladas" },
                brasil: { anual: 1.3e9, titulo: "üáßüá∑ Emiss√µes de CO‚ÇÇ do Brasil", legenda: "Estimativa para 2025: 1,3 bilh√£o de toneladas" },
                parana: { anual: 62.5e6, titulo: "üèûÔ∏è Emiss√µes de CO‚ÇÇ do Paran√°", legenda: "Estimativa para 2025: 62,5 milh√µes de toneladas" },
                curitiba: { anual: 8.1e6, titulo: "üèôÔ∏è Emiss√µes de CO‚ÇÇ de Curitiba", legenda: "Estimativa para 2025: 8,1 milh√µes de toneladas" }
            };

            const emissoesHistorico = {
                Marista: { titulo: "üåç Emiss√µes Globais de CO‚ÇÇ desde a cria√ß√£o do Marista (1817)", baseAte2025: 1848365645658.47, global2025: 37.4e9 },
                Santa: { titulo: "üåç Emiss√µes Globais de CO‚ÇÇ desde a cria√ß√£o do Santa Maria (1925)", baseAte2025: 1732301526553.08, global2025: 37.4e9 }
            };

            // Vari√°veis de estado
            let paginaAtualRegiao = "mundo";
            let paginaAtualHistorico = "Marista";
            let intervaloTroca1 = null;
            let intervaloTroca2 = null;
            
            // Definindo o ano m√≠nimo permitido com base nos dados dispon√≠veis
            const minAllowedYearForCustomCalc = 1750; // AGORA COME√áA EM 1750
            let customStartYear = minAllowedYearForCustomCalc; // Ano padr√£o inicial definido para o m√≠nimo
            
            let fixedEmissionsSumForCustomYear = 0;

            // Elementos DOM
            const co2NumeroElement = document.getElementById("co2Numero");
            const co2DescricaoElement = document.getElementById("co2Descricao");
            const tituloPaginaElement = document.getElementById("tituloPagina");
            const co2LegendaElement = document.getElementById("co2Legenda");
            const botoesRegiaoContainer = document.getElementById("botoesRegiao");
            const botoesRegiao = botoesRegiaoContainer ? botoesRegiaoContainer.querySelectorAll(".botao") : [];

            const co2NumeroElement2 = document.getElementById("co2Numero2");
            const co2DescricaoElement2 = document.getElementById("co2Descricao2");
            const tituloPaginaElement2 = document.getElementById("tituloPagina2");
            const botoesHistoricoContainer = document.getElementById("botoesHistorico");
            const botoesHistorico = botoesHistoricoContainer ? botoesHistoricoContainer.querySelectorAll(".botao") : [];

            const yearSelectorElement = document.getElementById("yearSelector");
            const selectedYearDisplayElement = document.getElementById("selectedYearDisplay");
            const yearDropdownListElement = document.getElementById("yearDropdownList");
            const btnCalcularAnoElement = document.getElementById("btnCalcularAno");
            const co2NumeroElement3 = document.getElementById("co2Numero3");
            const co2DescricaoElement3 = document.getElementById("co2Descricao3");
            const erroAnoElement = document.getElementById("erroAno");

            const relogioElement = document.getElementById("relogio");

            // Elementos da nova se√ß√£o de agroneg√≥cio
            const agroActivityElement = document.getElementById("agro-activity");
            const agroAreaElement = document.getElementById("agro-area");
            const agroCattleElement = document.getElementById("agro-cattle");
            const agroCattleGroupElement = document.getElementById("agroCattleGroup"); // Get the group
            const btnCalcularAgroElement = document.getElementById("btnCalcularAgro");
            const agroResultElement = document.getElementById("agroResult");

            // Fun√ß√µes de c√°lculo e atualiza√ß√£o
            function segundosTotaisNoAno(year) {
                return (new Date(year + 1, 0, 1) - new Date(year, 0, 1)) / 1000;
            }

            function segundosDesdeInicioDoAno(year) {
                const agora = new Date();
                if (agora.getFullYear() !== year) {
                    const startOfYear = new Date(agora.getFullYear(), 0, 1);
                    const secondsElapsed = (agora - startOfYear) / 1000;
                    const totalSecondsInCurrentActualYear = segundosTotaisNoAno(agora.getFullYear());
                    if (totalSecondsInCurrentActualYear === 0) return 0;
                    return Math.floor((secondsElapsed / totalSecondsInCurrentActualYear) * segundosTotaisNoAno(year));
                }
                const inicio = new Date(year, 0, 1);
                return Math.floor((agora - inicio) / 1000);
            }

            function formatarNumero(numero) {
                if (isNaN(numero)) {
                    console.warn("formatarNumero received NaN, returning '...'");
                    return "...";
                }
                return numero.toLocaleString('pt-BR', { maximumFractionDigits: 0, useGrouping: true });
            }

            function atualizarEmissoesRegiao() {
                const currentYear = 2025;
                const segundosAno = segundosTotaisNoAno(currentYear);
                const segundosPassados = segundosDesdeInicioDoAno(currentYear);
                const emissaoAnual = emissoes[paginaAtualRegiao].anual;

                if (segundosAno === 0) return;

                const emissaoPorSegundo = emissaoAnual / segundosAno;
                const emitido = emissaoPorSegundo * segundosPassados;

                if (co2NumeroElement) co2NumeroElement.textContent = formatarNumero(emitido);
                if (co2DescricaoElement) co2DescricaoElement.textContent = `toneladas emitidas at√© agora em ${currentYear}`;
            }

            function atualizarEmissoesHistorico() {
                const currentYear = 2025;
                const segundosAno = segundosTotaisNoAno(currentYear);
                const segundosPassados = segundosDesdeInicioDoAno(currentYear);
                const dadosHistorico = emissoesHistorico[paginaAtualHistorico];

                if (segundosAno === 0) return;

                const emissaoPorSegundo2025 = dadosHistorico.global2025 / segundosAno;
                const emitidoEm2025 = emissaoPorSegundo2025 * segundosPassados;
                const emitidoTotal = dadosHistorico.baseAte2025 + emitidoEm2025;

                if (co2NumeroElement2) co2NumeroElement2.textContent = formatarNumero(emitidoTotal);
                if (co2DescricaoElement2) {
                    if (paginaAtualHistorico === "Santa") {
                        co2DescricaoElement2.textContent = `toneladas emitidas desde a cria√ß√£o do Santa Maria`;
                    } else {
                        co2DescricaoElement2.textContent = `toneladas emitidas desde a cria√ß√£o do ${paginaAtualHistorico}`;
                    }
                }
            }

            function atualizarRelogio() {
                const agora = new Date();
                const horas = String(agora.getHours()).padStart(2, '0');
                const minutos = String(agora.getMinutes()).padStart(2, '0');
                if (relogioElement) relogioElement.textContent = `${horas}:${minutos}`;
            }

            function mudarPaginaRegiao(pagina) {
                if (!emissoes[pagina] || pagina === paginaAtualRegiao) return;
                paginaAtualRegiao = pagina;
                if (tituloPaginaElement) tituloPaginaElement.textContent = emissoes[pagina].titulo;
                if (co2LegendaElement) co2LegendaElement.textContent = emissoes[pagina].legenda;
                if (botoesRegiao) {
                    botoesRegiao.forEach(btn => {
                        btn.classList.remove("ativo");
                        if (btn.dataset.pagina === pagina) btn.classList.add("ativo");
                    });
                }
                atualizarEmissoesRegiao();
            }

            function mudarPaginaHistorico(pagina) {
                if (!emissoesHistorico[pagina] || pagina === paginaAtualHistorico) return;
                paginaAtualHistorico = pagina;
                if (tituloPaginaElement2) tituloPaginaElement2.textContent = emissoesHistorico[pagina].titulo;
                if (botoesHistorico) {
                    botoesHistorico.forEach(btn => {
                        btn.classList.remove("ativo");
                        if (btn.dataset.pagina2 === pagina) btn.classList.add("ativo");
                    });
                }
                atualizarEmissoesHistorico();
            }

            function iniciarTrocaAutomaticaRegiao() {
                if (intervaloTroca1) clearInterval(intervaloTroca1);
                const paginas = Object.keys(emissoes);
                if (paginas.length === 0) return;
                let index = paginas.indexOf(paginaAtualRegiao);
                if (index === -1) index = 0;
                intervaloTroca1 = setInterval(() => {
                    index = (index + 1) % paginas.length;
                    mudarPaginaRegiao(paginas[index]);
                }, 5000);
            }

            function iniciarTrocaAutomaticaHistorico() {
                if (intervaloTroca2) clearInterval(intervaloTroca2);
                const paginas = Object.keys(emissoesHistorico);
                if (paginas.length === 0) return;
                let index = paginas.indexOf(paginaAtualHistorico);
                if (index === -1) index = 0;
                intervaloTroca2 = setInterval(() => {
                    index = (index + 1) % paginas.length;
                    mudarPaginaHistorico(paginas[index]);
                }, 6000);
            }

            function populateYearDropdown() {
                if (!yearDropdownListElement || !selectedYearDisplayElement) {
                    console.error("Year dropdown elements not found for population.");
                    return;
                }
                yearDropdownListElement.innerHTML = '';
                const minYear = minAllowedYearForCustomCalc; // Usando o m√≠nimo permitido (1750)
                const maxYear = 2025;
                for (let year = maxYear; year >= minYear; year--) {
                    const yearItem = document.createElement('div');
                    yearItem.textContent = year;
                    yearItem.dataset.year = year;
                    if (year === customStartYear) {
                        yearItem.classList.add('selected-item');
                    }
                    yearItem.addEventListener('click', (e) => {
                        e.stopPropagation();
                        customStartYear = parseInt(e.target.dataset.year, 10);
                        selectedYearDisplayElement.textContent = customStartYear;

                        const currentlySelected = yearDropdownListElement.querySelector('.selected-item');
                        if (currentlySelected) {
                            currentlySelected.classList.remove('selected-item');
                        }
                        e.target.classList.add('selected-item');

                        if (yearSelectorElement) yearSelectorElement.classList.remove('open');
                    });
                    yearDropdownListElement.appendChild(yearItem);
                }
                // Garante que o ano selecionado padr√£o seja ajustado se estiver fora do novo range
                if (customStartYear < minYear) {
                    customStartYear = minYear;
                }
                selectedYearDisplayElement.textContent = customStartYear;
            }

            // Event listeners para o seletor de ano
            if (yearSelectorElement) {
                yearSelectorElement.addEventListener('click', (e) => {
                    if (e.target === yearDropdownListElement) return;
                    yearSelectorElement.classList.toggle('open');
                });
                document.addEventListener('click', (event) => {
                    if (yearSelectorElement && !yearSelectorElement.contains(event.target)) {
                        yearSelectorElement.classList.remove('open');
                    }
                });
                yearSelectorElement.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter' || event.key === ' ') {
                        event.preventDefault();
                        yearSelectorElement.classList.toggle('open');
                    } else if (event.key === 'Escape') {
                        yearSelectorElement.classList.remove('open');
                    }
                });
            }

            function aoClicarBotaoRegiao(event) {
                console.log("aoClicarBotaoRegiao triggered");
                const pagina = event.target.dataset.pagina;
                if (pagina) {
                    if (intervaloTroca1) {
                        clearInterval(intervaloTroca1);
                        intervaloTroca1 = null;
                    }
                    mudarPaginaRegiao(pagina);
                }
            }

            function aoClicarBotaoHistorico(event) {
                console.log("aoClicarBotaoHistorico triggered");
                const pagina = event.target.dataset.pagina2;
                if (pagina) {
                    if (intervaloTroca2) {
                        clearInterval(intervaloTroca2);
                        intervaloTroca2 = null;
                    }
                    mudarPaginaHistorico(pagina);
                }
            }

            function aoCalcularAnoCustomizado() {
                console.log("[Calcular Custom] aoCalcularAnoCustomizado called");
                const anoInput = customStartYear;
                console.log("[Calcular Custom] Using customStartYear:", anoInput);

                if (erroAnoElement) erroAnoElement.textContent = "";

                if (isNaN(anoInput) || anoInput < minAllowedYearForCustomCalc || anoInput > 2025) { // Usando o m√≠nimo permitido (1750)
                    if (erroAnoElement) erroAnoElement.textContent = `Ano selecionado inv√°lido. Selecione entre ${minAllowedYearForCustomCalc} e 2025.`;
                    fixedEmissionsSumForCustomYear = 0;
                    console.log("[Calcular Custom] Validation failed for anoInput from customStartYear.");
                    atualizarEmissoesCustomYear();
                    return;
                }

                fixedEmissionsSumForCustomYear = 0;
                for (let year = anoInput; year <= 2023; year++) {
                    const yearStr = year.toString();
                    if (co2EmissionsByYear.hasOwnProperty(yearStr) && typeof co2EmissionsByYear[yearStr] === 'number' && !isNaN(co2EmissionsByYear[yearStr])) {
                        fixedEmissionsSumForCustomYear += co2EmissionsByYear[yearStr] * 1e9; // Os dados est√£o em GtCO2, multiplicamos por 1e9 para toneladas
                    } else {
                        console.warn(`[Calcular Custom] Data for year ${yearStr} problem. Value:`, co2EmissionsByYear[yearStr]);
                    }
                }
                console.log(`[Calcular Custom] Sum from ${anoInput}-2023:`, fixedEmissionsSumForCustomYear);

                if (anoInput <= 2024) {
                    if (typeof EMISSIONS_2024_ANNUAL === 'number' && !isNaN(EMISSIONS_2024_ANNUAL)) {
                        fixedEmissionsSumForCustomYear += EMISSIONS_2024_ANNUAL;
                    } else {
                        console.warn("[Calcular Custom] EMISSIONS_2024_ANNUAL problem:", EMISSIONS_2024_ANNUAL);
                    }
                }
                console.log(`[Calcular Custom] Sum after 2024 (if ${anoInput} <= 2024):`, fixedEmissionsSumForCustomYear);

                if (isNaN(fixedEmissionsSumForCustomYear)) {
                    console.error("[Calcular Custom] CRITICAL: fixedEmissionsSumForCustomYear became NaN.");
                    if (erroAnoElement) erroAnoElement.textContent = "Erro ao calcular dados hist√≥ricos.";
                    customStartYear = minAllowedYearForCustomCalc; // Redefinir para o m√≠nimo permitido
                    if (selectedYearDisplayElement) selectedYearDisplayElement.textContent = customStartYear;
                    if (yearDropdownListElement) {
                        const oldSel = yearDropdownListElement.querySelector('.selected-item');
                        if (oldSel) oldSel.classList.remove('selected-item');
                        const newSel = yearDropdownListElement.querySelector(`[data-year="${customStartYear}"]`);
                        if (newSel) newSel.classList.add('selected-item');
                    }
                }
                atualizarEmissoesCustomYear();
            }

            function atualizarEmissoesCustomYear() {
                if (customStartYear === null || isNaN(customStartYear)) {
                    if (co2NumeroElement3) co2NumeroElement3.textContent = "...";
                    if (co2DescricaoElement3) co2DescricaoElement3.textContent = "Selecione um ano e calcule.";
                    return;
                }

                const currentYearForCalc = 2025;
                let totalEmitidoDesdeCustomYear = fixedEmissionsSumForCustomYear;

                if (isNaN(totalEmitidoDesdeCustomYear)) {
                    console.error("[Atualizar Custom] fixedEmissionsSumForCustomYear is NaN before adding 2025 part! Value:", fixedEmissionsSumForCustomYear);
                    if (co2NumeroElement3) co2NumeroElement3.textContent = "Erro";
                    if (co2DescricaoElement3) co2DescricaoElement3.textContent = "Erro no c√°lculo base.";
                    return;
                }

                if (customStartYear <= currentYearForCalc) {
                    const segundosAno2025 = segundosTotaisNoAno(currentYearForCalc);
                    const segundosPassados2025 = segundosDesdeInicioDoAno(currentYearForCalc);
                    const emissaoAnual2025Mundo = emissoes.mundo.anual;

                    if (segundosAno2025 > 0) {
                        const emissaoPorSegundo2025 = emissaoAnual2025Mundo / segundosAno2025;
                        const emitidoEm2025 = emissaoPorSegundo2025 * segundosPassados2025;
                        if (!isNaN(emitidoEm2025)) {
                            totalEmitidoDesdeCustomYear += emitidoEm2025;
                        } else {
                            console.warn("[Atualizar Custom] emitidoEm2025 for 2025 calculation is NaN.");
                        }
                    }
                }
                if (co2NumeroElement3) co2NumeroElement3.textContent = formatarNumero(totalEmitidoDesdeCustomYear);
                if (co2DescricaoElement3) co2DescricaoElement3.textContent = `toneladas de CO‚ÇÇ emitidas globalmente desde ${customStartYear} at√© agora`;
            }

            // Nova fun√ß√£o para calcular emiss√µes do agroneg√≥cio
            function calcularEmissoesAgronegocio() {
                const activity = agroActivityElement.value;
                const area = parseFloat(agroAreaElement.value);
                const cattle = parseFloat(agroCattleElement.value);

                if (isNaN(area) || area <= 0) {
                    agroResultElement.textContent = "Por favor, insira uma √°rea v√°lida.";
                    return;
                }

                if (activity === "pecuaria" && (isNaN(cattle) || cattle <= 0)) {
                    agroResultElement.textContent = "Para pecu√°ria, insira o n√∫mero de cabe√ßas.";
                    return;
                }

                let emissions = 0;
                let description = "";

                if (activity === "pecuaria") {
                    emissions = cattle * agroEmissions[activity];
                    description = `${formatarNumero(emissions)} toneladas de CO‚ÇÇ equivalente por ano para ${cattle} cabe√ßas de gado`;
                } else {
                    emissions = area * agroEmissions[activity];
                    const activityNames = {
                        soja: "soja",
                        milho: "milho",
                        cana: "cana-de-a√ß√∫car"
                    };
                    description = `${formatarNumero(emissions)} toneladas de CO‚ÇÇ equivalente por ano para ${area} hectares de ${activityNames[activity]}`;
                }

                agroResultElement.textContent = description;
            }

            // Fun√ß√£o para controlar a visibilidade do campo de cabe√ßas de gado
            function toggleCattleInputVisibility() {
                if (agroActivityElement.value === 'pecuaria') {
                    agroCattleGroupElement.style.display = 'flex';
                    agroCattleElement.disabled = false;
                    agroAreaElement.placeholder = "Ex: 100 (√°rea da pastagem)";
                } else {
                    agroCattleGroupElement.style.display = 'none';
                    agroCattleElement.disabled = true;
                    agroCattleElement.value = ''; // Clear value when hidden
                    agroAreaElement.placeholder = "Ex: 1000";
                }
            }

            // Event listener para habilitar/desabilitar o campo de cabe√ßas de gado
            if (agroActivityElement && agroCattleGroupElement && agroCattleElement) {
                agroActivityElement.addEventListener('change', toggleCattleInputVisibility);
                // Initial call to set correct state on page load
                toggleCattleInputVisibility(); 
            }

            // Event listener para o bot√£o de calcular emiss√µes do agroneg√≥cio
            if (btnCalcularAgroElement) {
                btnCalcularAgroElement.addEventListener('click', calcularEmissoesAgronegocio);
            }
            // Inicializa√ß√£o dos gr√°ficos com elementos centralizados
            function inicializarGraficos() {
                // Gr√°fico 1: Emiss√µes por Cultura (com escala logar√≠tmica)
                const ctxEmissions = document.getElementById('emissionsChart');
                if (ctxEmissions) {
                    new Chart(ctxEmissions, {
                        type: 'bar',
                        data: {
                            labels: ['Soja', 'Milho', 'Cana-de-a√ß√∫car', 'Pecu√°ria (por cabe√ßa)'],
                            datasets: [{
                                // Removendo o label do dataset, pois a legenda ser√° removida
                                data: [0.85, 0.72, 0.45, 56.2],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.7)',
                                    'rgba(54, 162, 235, 0.7)',
                                    'rgba(255, 206, 86, 0.7)',
                                    'rgba(75, 192, 192, 0.7)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            layout: { // Ajustes de padding para dar espa√ßo ao t√≠tulo do eixo Y e r√≥tulos X
                                padding: {
                                    left: 60, // Aumentado para dar espa√ßo ao t√≠tulo do eixo Y (rotacionado)
                                    right: 20, // Espa√ßo para o √∫ltimo r√≥tulo X n√£o ser cortado
                                    bottom: 20 // Espa√ßo para os r√≥tulos do eixo X
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false // Removendo a legenda completamente
                                },
                                title: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    type: 'logarithmic', // Aplicando escala logar√≠tmica
                                    beginAtZero: true,
                                    title: { // Adicionando t√≠tulo ao eixo Y
                                        display: true,
                                        text: 'tCO‚ÇÇeq (Escala Logar√≠tmica)',
                                        color: 'white',
                                        font: {
                                            size: 14,
                                            weight: 'bold'
                                        }
                                    },
                                    ticks: {
                                        color: 'white',
                                        callback: function(value, index, ticks) {
                                            // Format ticks for better readability on log scale
                                            // Show powers of 10 and significant values
                                            if (value === 0.1 || value === 1 || value === 10 || value === 100) {
                                                return value;
                                            }
                                            // For values between powers of 10, show if they are easy to read (e.g., 0.2, 0.5)
                                            if (value > 0 && value < 100 && (value * 10) % 1 === 0 && (value.toString().length < 4 || value % 5 === 0)) {
                                                return value;
                                            }
                                            return null;
                                        }
                                    },
                                    grid: {
                                        color: 'rgba(255, 255, 255, 0.1)'
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: 'white',
                                        maxRotation: 45,   // Permitir rota√ß√£o para etiquetas na diagonal
                                        minRotation: 45,   // Definir rota√ß√£o m√≠nima para diagonal
                                        autoSkip: false,  // Garante que todas as etiquetas sejam exibidas
                                        font: {
                                            size: 10 // Reduz o tamanho da fonte para evitar sobreposi√ß√£o
                                        },
                                        padding: 5 // Adiciona um pequeno padding entre as etiquetas e o eixo
                                    },
                                    grid: {
                                        color: 'rgba(255, 255, 255, 0.1)'
                                    }
                                }
                            }
                        }
                    });
                }

                // Gr√°fico 2: √Årea cultivada
                const ctxArea = document.getElementById('areaChart');
                if (ctxArea) {
                    new Chart(ctxArea, {
                        type: 'doughnut',
                        data: {
                            labels: ['Soja', 'Milho', 'Cana-de-a√ß√∫car', 'Outras'],
                            datasets: [{
                                label: 'Milh√µes de hectares',
                                data: [41.2, 21.5, 10.4, 27.1],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.7)',
                                    'rgba(54, 162, 235, 0.7)',
                                    'rgba(255, 206, 86, 0.7)',
                                    'rgba(153, 102, 255, 0.7)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(153, 102, 255, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: 'white',
                                        font: {
                                            size: 12
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

                // Gr√°fico 3: Emiss√µes por setor
                const ctxSector = document.getElementById('sectorChart');
                if (ctxSector) {
                    new Chart(ctxSector, {
                        type: 'pie',
                        data: {
                            labels: ['Pecu√°ria', 'Soja', 'Cana-de-a√ß√∫car', 'Outras culturas'],
                            datasets: [{
                                label: 'Milh√µes de tCO‚ÇÇeq',
                                data: [415, 125, 85, 75],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.7)',
                                    'rgba(54, 162, 235, 0.7)',
                                    'rgba(255, 206, 86, 0.7)',
                                    'rgba(75, 192, 192, 0.7)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: 'white',
                                        font: {
                                            size: 12
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

                // Gr√°fico 4: Compara√ß√£o Agroneg√≥cio vs Agricultura Familiar
                const ctxComparison = document.getElementById('comparisonChart');
                if (ctxComparison) {
                    new Chart(ctxComparison, {
                        type: 'bar',
                        data: {
                            labels: ['Produ√ß√£o de Alimentos', 'Emprego', 'Uso da Terra', 'Emiss√µes por hectare'],
                            datasets: [
                                {
                                    label: 'Agroneg√≥cio',
                                    data: [70, 20, 75, 80],
                                    backgroundColor: 'rgba(255, 99, 132, 0.7)',
                                    borderColor: 'rgba(255, 99, 132, 1)',
                                    borderWidth: 1
                                },
                                {
                                    label: 'Agricultura Familiar',
                                    data: [30, 80, 25, 20],
                                    backgroundColor: 'rgba(54, 162, 235, 0.7)',
                                    borderColor: 'rgba(54, 162, 235, 1)',
                                    borderWidth: 1
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: {
                                        color: 'white'
                                    },
                                    grid: {
                                        color: 'rgba(255, 255, 255, 0.1)'
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: 'white'
                                    },
                                    grid: {
                                        color: 'rgba(255, 255, 255, 0.1)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: 'white',
                                        font: {
                                            size: 12
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            }

            // Configura√ß√£o inicial
            console.log("Setting up event listeners...");
            if (botoesRegiaoContainer) botoesRegiaoContainer.addEventListener('click', aoClicarBotaoRegiao);
            if (botoesHistoricoContainer) botoesHistoricoContainer.addEventListener('click', aoClicarBotaoHistorico);
            if (btnCalcularAnoElement) btnCalcularAnoElement.addEventListener('click', aoCalcularAnoCustomizado);

            console.log("Initial page setup...");
            mudarPaginaRegiao(paginaAtualRegiao);
            mudarPaginaHistorico(paginaAtualHistorico);
            atualizarRelogio();

            console.log("Populating year dropdown...");
            populateYearDropdown(); // Popula o dropdown com o novo range

            console.log("Attempting initial calculation for custom year section with default value (which is now guaranteed to be >= 1750)...");
            aoCalcularAnoCustomizado(); // Realiza o c√°lculo inicial com o ano de in√≠cio corrigido

            console.log("Initializing charts...");
            inicializarGraficos();

            console.log("Starting intervals...");
            setInterval(() => {
                atualizarEmissoesRegiao();
                atualizarEmissoesHistorico();
                atualizarEmissoesCustomYear(); // Mant√©m a atualiza√ß√£o a cada segundo
                atualizarRelogio();
            }, 1000);

            iniciarTrocaAutomaticaRegiao();
            iniciarTrocaAutomaticaHistorico();

            console.log("Script initialization complete.");
        });
    </script>
</body>
</html>